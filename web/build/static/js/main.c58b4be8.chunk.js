(this.webpackJsonppocassist=this.webpackJsonppocassist||[]).push([[0],{2172:function(e,t,a){},2184:function(e,t,a){},2340:function(e,t,a){},2367:function(e,t,a){},2368:function(e,t,a){},2369:function(e,t,a){},2372:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(14),c=a.n(r),o=(a(417),a(418),a(16)),i=a.n(o),u=(a(151),a(95)),s=a.n(u),d=(a(421),a(422),a(411)),m=a(63),p=a(36),f=a(7),v=(a(152),a(78)),b=a.n(v),E=(a(86),a(43)),h=a.n(E),O=(a(46),a(17)),g=a.n(O),y=(a(256),a(176)),j=a.n(y),w=(a(428),a(407)),C=a.n(w),S=(a(257),a(72)),k=a.n(S),T=(a(67),a(31)),I=a.n(T),A=(a(68),a(11)),x=a.n(A),N=a(403),D=a.n(N),F=a(2384),L=a(2385),_={collapsed:!1},P=l.a.createContext({state:_,dispatch:function(){}}),z=a(251),R=a.n(z),M=a(404),V=a(405),G=a.n(V),Q=a(186),U=a.n(Q),H=function(){return localStorage.getItem("token-key")},J=function(){return JSON.parse(localStorage.getItem("userInfo"))},Y=G.a.create({baseURL:"/api",timeout:"500000",withCredentials:!0,headers:{"Content-type":"application/json"},maxRedirects:0,paramsSerializer:function(e){for(var t in e)e[t]||(e[t]=null);var a=U.a.stringify(e,{skipNulls:!0});return U.a.stringify(U.a.parse(a),{arrayFormat:"repeat"})}});Y.interceptors.request.use((function(e){return e.headers.Authorization="JWT ".concat(H()),e})),Y.interceptors.response.use((function(e){if(void 0!==e.data.code){var t,a=e.data;return a&&!a.code?(I.a.error((null===(t=e.data)||void 0===t?void 0:t.msg)||a.error),Promise.reject()):a}return e}),function(){var e=Object(M.a)(R.a.mark((function e(t){var a;return R.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 401===(null===(a=t.response)||void 0===a?void 0:a.status)&&(window.location.href="/"),I.a.error(t.toString()),e.abrupt("return",Promise.reject());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());var q=Y,K=b.a.Header,B=function(e){var t,a=Object(p.g)(),r=x.a.useForm(),c=Object(f.a)(r,1)[0],o=Object(n.useContext)(P),i=o.state,u=o.dispatch,s=Object(n.useState)(!1),d=Object(f.a)(s,2),m=d[0],v=d[1],b=l.a.createElement(k.a,null,l.a.createElement(k.a.Item,{onClick:function(){return v(!0)}},"\u4fee\u6539\u5bc6\u7801"),l.a.createElement(k.a.Item,{onClick:function(){q({url:"/v1/user/logout",method:"get"}).then((function(e){localStorage.removeItem("token-key"),a.push("/login")}))}},"\u9000\u51fa\u767b\u5f55"));return l.a.createElement(K,null,l.a.createElement("div",{className:"header-left-wrap"},l.a.createElement("div",{className:"header-left",onClick:function(){u({type:"TOGGLE_COLLAPSED"})}},i.collapsed?l.a.createElement(F.a,null):l.a.createElement(L.a,null))),l.a.createElement("div",{className:"header-right"},l.a.createElement(C.a,{size:32,src:D.a}),l.a.createElement(j.a,{overlayStyle:{width:"180px",zIndex:2e3},overlay:b},l.a.createElement("div",{className:"ant-dropdown-link"},l.a.createElement("div",null,"\u6b22\u8fce\uff0c",null===(t=J())||void 0===t?void 0:t.name)))),l.a.createElement(h.a,{visible:m,onCancel:function(){return v(!1)},onOk:c.submit,title:"\u4fee\u6539\u5bc6\u7801",forceRender:!0},l.a.createElement(x.a,{form:c,onFinish:function(e){var t;(t={password:e.password,newpassword:e.newpassword},q({url:"/v1/user/self/resetpwd/",method:"post",data:t})).then((function(e){I.a.success("\u4fee\u6539\u5bc6\u7801\u6210\u529f"),v(!1)}))},labelCol:{span:6}},l.a.createElement(x.a.Item,{name:"password",label:"\u539f\u5bc6\u7801",rules:[{required:!0}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u539f\u5bc6\u7801"})),l.a.createElement(x.a.Item,{name:"newpassword",label:"\u65b0\u5bc6\u7801",rules:[{required:!0}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801"})),l.a.createElement(x.a.Item,{name:"new_password_confirm",label:"\u518d\u6b21\u8f93\u5165\u5bc6\u7801",dependencies:["newpassword"],rules:[{required:!0,message:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"},function(e){var t=e.getFieldValue;return{validator:function(e,a){return a&&t("newpassword")!==a?Promise.reject("\u4e24\u6b21\u8f93\u5165\u65b0\u5bc6\u7801\u4e0d\u4e00\u81f4"):Promise.resolve()}}}]},l.a.createElement(g.a,{type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u65b0\u5bc6\u7801"})))))},X=(a(336),a(37)),Z=a(6),W=(a(638),a(408)),$=a.n(W),ee=(a(34),a(12)),te=a.n(ee),ae=a(50),ne=(a(640),a(41)),le=["captcha_value"],re=function(e){var t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(p.g)();return l.a.createElement("div",{className:"apply-login-wrap"},l.a.createElement("div",{className:"apply-login-page"},l.a.createElement("h2",{className:"login-title"},"POCASSIST"),l.a.createElement(x.a,Object.assign({},{labelCol:{span:24},wrapper:{span:24}},{form:a,onFinish:function(e){e.captcha_value;var t,a=Object(ae.a)(e,le);(t=a,q({url:"/v1/user/login",method:"post",data:t})).then((function(e){var t;!function(e){localStorage.setItem("token-key",e)}(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.token),q({url:"/v1/user/info",method:"get"}).then((function(e){!function(e){localStorage.setItem("userInfo",JSON.stringify(e))}(e.data)})).finally((function(){r.push("/poc")}))}))},hideRequiredMark:!0,size:"large"}),l.a.createElement(n.Fragment,null,l.a.createElement(x.a.Item,{label:"\u7528\u6237",name:"username",rules:[{required:!0}]},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",prefix:l.a.createElement(ne.MobileOutlined,null)})),l.a.createElement(x.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0}]},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801",maxLength:40,prefix:l.a.createElement(ne.UnlockOutlined,null),type:"password"}))),l.a.createElement(x.a.Item,{wrapperCol:{span:24}},l.a.createElement(te.a,{type:"primary",htmlType:"submit",block:!0},"\u767b\u5f55"))),l.a.createElement($.a,null),l.a.createElement("div",{className:"login-footer"},l.a.createElement("p",null,"Copyright https://github.com/jweny"))))},ce=(a(2172),a(89),a(18)),oe=a.n(ce),ie={search_query:{},page:1,pagesize:20,productList:[]},ue=l.a.createContext({state:ie,dispatch:function(){}}),se=["name","label","render"],de=function(e){var t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(n.useContext)(ue),c=r.state,o=r.dispatch,i=[{name:"typeField",label:"\u6f0f\u6d1e\u7c7b\u578b",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},allowClear:!0},null===(e=c.basic)||void 0===e?void 0:e.VulType.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"productField",label:"\u7ec4\u4ef6",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:120},allowClear:!0},null===(e=c.productList)||void 0===e?void 0:e.map((function(e){return l.a.createElement(oe.a.Option,{value:e.id,key:e.id},e.name)})))}},{name:"search",label:"\u6a21\u7cca\u67e5\u8be2"}];return l.a.createElement(x.a,{form:a,layout:"inline",className:"vul-manage-form",onFinish:function(e){o({type:"SET_SEARCH_QUERY",payload:e})}},i.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n),allowClear:!0})}:r,o=Object(ae.a)(e,se);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))},me=(a(121),a(65)),pe=a.n(me),fe=(a(141),a(76)),ve=a.n(fe),be=(a(122),a(64)),Ee=a.n(be),he=(a(170),a(47)),Oe=a.n(he),ge=(a(171),a(32)),ye=a.n(ge),je=(a(354),a(132)),we=a.n(je),Ce=(a(2184),function(e){var t=e.className,a=e.columns,r=e.setColumns,c=e.allColumns,o=Object(n.useState)(!1),i=Object(f.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)([]),m=Object(f.a)(d,2),p=m[0],v=m[1],b=Object(n.useState)({check:!1,indeterminate:!0}),E=Object(f.a)(b,2),O=E[0],g=E[1],y=Object(n.useCallback)((function(){v(a.map((function(e){return e.dataIndex}))),g({check:a.length===c.length,indeterminate:a.length>0&&a.length<c.length})}),[a,c]);Object(n.useEffect)((function(){y()}),[y]);var j=function(){s((function(e){return!e}))};return l.a.createElement("div",{className:t+" custom-columns-wrap"},l.a.createElement(te.a,{type:"link",onClick:j},"\u81ea\u5b9a\u4e49"),l.a.createElement(h.a,{visible:u,title:"\u81ea\u5b9a\u4e49\u8868\u5934",onCancel:function(){s(!1),y()},onOk:function(){var e=c.filter((function(e){return-1!==p.indexOf(e.dataIndex)}));r(e),j()},width:800,wrapClassName:"custom-columns-modal"},l.a.createElement("div",{className:"site-checkbox-all-wrapper"},l.a.createElement(we.a,{indeterminate:O.indeterminate,onChange:function(e){var t=e.target.checked;g({indeterminate:!1,check:t}),v(t?c.map((function(e){return e.dataIndex})):[])},checked:O.check},"\u5168\u9009")),l.a.createElement(we.a.Group,{name:"columns",value:p,onChange:function(e){v(e),g({check:e.length===c.length,indeterminate:e.length>0&&e.length<c.length})},style:{width:"100%"}},l.a.createElement(Oe.a,null,c.map((function(e){return l.a.createElement(ye.a,{span:6,key:e.dataIndex},l.a.createElement(we.a,{value:e.dataIndex},e.title))}))))))}),Se=[{name:"description",label:"\u63cf\u8ff0"},{name:"suggestion",label:"\u4fee\u590d\u5efa\u8bae"}],ke=(a(2185),a(249)),Te=a.n(ke),Ie=function(e){return q({url:"/v1/product/",method:"get",params:e})},Ae=function(e){return q({url:"/v1/product/",method:"post",data:e})},xe=function(e){return q({url:"/v1/product/".concat(e,"/"),method:"delete"})},Ne=function(e,t){return q({url:"/v1/product/".concat(t,"/"),method:"put",data:e})},De=function(e){return q({url:"/v1/vul/",method:"get",params:e})},Fe=function(){return q({url:"/v1/vul/basic/",method:"get"})},Le=function(e){return q({url:"/v1/vul/",method:"post",data:e})},_e=function(e,t){return q({url:"/v1/vul/".concat(t,"/"),method:"put",data:e})},Pe=a(254),ze=a.n(Pe),Re=(a(387),[{title:"\u7ec4\u4ef6\u540d\u79f0",dataIndex:"name",width:"20%"},{title:"\u5382\u5546",dataIndex:"provider",width:"20%"},{title:"\u5907\u6ce8",dataIndex:"remarks",width:"30%"}]),Me=[{name:"name",label:"\u7ec4\u4ef6\u540d\u79f0",rules:[{required:!0}]},{name:"provider",label:"\u5382\u5546"},{name:"remarks",label:"\u5907\u6ce8",render:function(){return l.a.createElement(g.a.TextArea,null)}}],Ve=["name","label","render"],Ge=function(e){var t,a=e.type,r=e.selected,c=x.a.useForm(),o=Object(f.a)(c,1)[0];switch(Object(n.useEffect)((function(){o.resetFields()}),[r,o]),a){case"product":t=Me;break;default:t=Me}return l.a.createElement(h.a,Object.assign({},e,{forceRender:!0,title:(r?"\u7f16\u8f91":"\u65b0\u589e")+("script"===a?"\u811a\u672c":"product"===a?"\u7ec4\u4ef6":"\u6a21\u5757"),footer:l.a.createElement("div",null,l.a.createElement(te.a,{type:"primary",onClick:o.submit},r?"\u4fdd\u5b58":"\u6dfb\u52a0"),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88"))}),l.a.createElement(x.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:o,onFinish:function(t){e.onOk&&e.onOk(t)},initialValues:r||{}}),t.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,Ve);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a},o),c())}))))},Qe=["name","label","render"],Ue=["name","label"],He=function(e){var t=e.selected,a=e.type,r=void 0===a?"vul":a,c=Object(n.useRef)(null),o=Object(n.useState)(1),i=Object(f.a)(o,2),u=i[0],d=i[1],m=Object(n.useState)(null),p=Object(f.a)(m,2),v=p[0],b=p[1],E=Object(n.useState)(void 0),O=Object(f.a)(E,2),y=O[0],j=O[1],w=Object(n.useState)(!0),C=Object(f.a)(w,2),S=C[0],k=C[1],T=Object(n.useContext)(ue),A=T.state,N=T.dispatch,D=Object(n.useState)(!1),F=Object(f.a)(D,2),L=F[0],_=F[1],P=x.a.useForm(),z=Object(f.a)(P,1)[0];Object(n.useEffect)((function(){t?(b(t),d(1),k(!1)):k(!1)}),[t,r]);var R=[{name:"webapp",label:"\u5f71\u54cd\u7ec4\u4ef6",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},onSelect:function(e){"new"===e&&_(!0)}},null===(e=A.productList)||void 0===e?void 0:e.map((function(e){return l.a.createElement(oe.a.Option,{value:e.id,key:e.id},e.name)})),l.a.createElement(oe.a.Option,{value:"new"},"\u65b0\u589e ",l.a.createElement(ne.PlusOutlined,null)))}},{name:"severity",label:"\u6f0f\u6d1e\u7b49\u7ea7",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=A.basic)||void 0===e?void 0:e.VulLevel.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"category",label:"\u6f0f\u6d1e\u7c7b\u578b",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=A.basic)||void 0===e?void 0:e.VulType.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"language",label:"\u6f0f\u6d1e\u8bed\u8a00",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200}},null===(e=A.basic)||void 0===e?void 0:e.VulLanguage.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"cve",label:"CVE\u7f16\u53f7"},{name:"cnnvd",label:"CNNVD\u7f16\u53f7"}],M=["font-size","line-height","letter-spacing","headings","text-indent","text-align","emoji","hr","separator"],V=function(e){2===e?z.validateFields().then((function(t){d(e)})).catch((function(){})):d(e)},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};V(1),e.onCancel&&e.onCancel(t)},Q=document.documentElement.offsetHeight;return l.a.createElement(h.a,Object.assign({},e,{destroyOnClose:!0,maskClosable:!1,onCancel:function(e){G(e)},footer:l.a.createElement("div",null,1===u&&l.a.createElement(l.a.Fragment,null,l.a.createElement(te.a,{type:"primary",onClick:function(){z.validateFields().then((function(e){var t=Object(Z.a)({},e);Se.map((function(a){t[a.name]=e[a.name]&&"object"===typeof e[a.name]?e[a.name].toHTML():e[a.name]})),b((function(e){return Object(Z.a)(Object(Z.a)({},e),t)})),console.log(Object(Z.a)(Object(Z.a)({},v),t)),function(e){var t;k(!0);var a=J(),n=(null===v||void 0===v?void 0:v.id)||y?_e:Le,l=null===(t=c.current)||void 0===t?void 0:t.getRunTestData();n(Object(Z.a)(Object(Z.a)(Object(Z.a)({},v),e),{},{writer_id:null===a||void 0===a?void 0:a.id},l),(null===v||void 0===v?void 0:v.id)||y).then((function(e){j(e.data.id),I.a.success("\u4fdd\u5b58\u6210\u529f"),De(Object(Z.a)(Object(Z.a)({},A.search_query),{},{page:A.page,pagesize:A.pagesize})).then((function(e){N({type:"SET_LIST",payload:e.data.data}),N({type:"SET_TOTAL",payload:e.data.total}),G()}))})).finally((function(){k(!1)}))}(Object(Z.a)(Object(Z.a)({},v),t))})).catch((function(e){}))}},"\u4fdd\u5b58")),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88")),bodyStyle:{maxHeight:Q-120,overflowY:"scroll"}}),l.a.createElement(s.a,{spinning:S},l.a.createElement(x.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:z,name:"vul_detail",layout:"horizontal",initialValues:v,style:{display:"".concat(1===u?"flex":"none")}}),l.a.createElement(x.a.Item,{name:"name_zh",label:"\u6f0f\u6d1e\u540d\u79f0",rules:[{required:!0}],className:"form-item-long",labelCol:{span:3},wrapperCol:{span:20}},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u6f0f\u6d1e\u540d\u79f0"})),R.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,Qe);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(Oe.a,{style:{width:"100%",marginBottom:24}},l.a.createElement(ye.a,{offset:3},l.a.createElement(Te.a,{message:"\u6ce8\u610f\u4ee5\u4e0b\u4e3a\u5bcc\u6587\u672c\uff1a\u590d\u5236\u7c98\u8d34\u6765\u7684\u6587\u672c\u5148\u6e05\u9664\u683c\u5f0f"}))),Se.map((function(e,t){var a=e.name,n=e.label,r=Object(ae.a)(e,Ue);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a,labelCol:{span:3},wrapperCol:{span:20},validateTrigger:"onBlur",getValueProps:function(e){return{value:ze.a.createEditorState(e)}},className:"form-item-long"},r),l.a.createElement(ze.a,{excludeControls:M,placeholder:"\u8bf7\u8f93\u5165".concat(n),style:{border:"1px solid #ccc"},contentStyle:{height:200,overflow:"auto"}}))})))),l.a.createElement(Ge,{visible:L,onCancel:function(){_(!1)},onOk:function(e){Ae(e).then((function(e){_(!1),Ie({page:1,pagesize:9999}).then((function(e){N({type:"SET_PRODUCT_LIST",payload:e.data.data})})),z.setFieldsValue({product:e.data.id})}))},type:"product",selected:void 0}))},Je=function(e){var t=[{title:"\u6f0f\u6d1e\u540d\u79f0",dataIndex:"name_zh",ellipsis:!1,width:"30%"},{title:"\u5f71\u54cd\u7ec4\u4ef6",dataIndex:"webapp_name",ellipsis:!0},{title:"\u6f0f\u6d1e\u7c7b\u578b",dataIndex:"category",ellipsis:!0},{title:"cve\u7f16\u53f7",dataIndex:"cve",ellipsis:!0},{title:"cnnvd\u7f16\u53f7",dataIndex:"cnnvd",ellipsis:!0},{title:"\u4fee\u590d\u5efa\u8bae",dataIndex:"suggestion",ellipsis:!0},{title:"\u6f0f\u6d1e\u7b49\u7ea7",dataIndex:"severity",ellipsis:!0,render:function(e){switch(e){case"high":return"\u9ad8\u5371";case"middle":return"\u4e2d\u5371";case"low":return"\u4f4e\u5371";case"info":return"\u4fe1\u606f";default:return""}}},{title:"\u6f0f\u6d1e\u8bed\u8a00",dataIndex:"language",ellipsis:!0},{title:"\u4e0a\u4f20\u8005",dataIndex:"writer_name",ellipsis:!0}],a=Object(n.useState)(!1),r=Object(f.a)(a,2),c=r[0],o=r[1],i=Object(n.useState)(Object(X.a)(t.slice(0,4))),u=Object(f.a)(i,2),s=u[0],d=u[1],m=Object(n.useState)(!1),p=Object(f.a)(m,2),v=p[0],b=p[1],E=Object(n.useState)(void 0),h=Object(f.a)(E,2),O=h[0],g=h[1],y=Object(n.useContext)(ue),j=y.state,w=y.dispatch,C=function(){o(!0),De(Object(Z.a)(Object(Z.a)({},j.search_query),{},{page:j.page,pagesize:j.pagesize})).then((function(e){w({type:"SET_LIST",payload:e.data.data}),w({type:"SET_TOTAL",payload:e.data.total})})).finally((function(){o(!1)}))};Object(n.useEffect)((function(){C()}),[j.page,j.pagesize,j.search_query]);var S=[{title:"\u5e8f\u53f7",dataIndex:"order",width:"8%",render:function(e,t,a){return a+1}}].concat(Object(X.a)(s),[{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(te.a,{type:"link",onClick:function(){var e;o(!0),(e=t.id,q({url:"/v1/vul/".concat(e,"/"),method:"get"})).then((function(e){g(e.data||t),k()})).finally((function(){o(!1)}))}},"\u8be6\u60c5"),l.a.createElement(Ee.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u6761\u6f0f\u6d1e\u5417\uff1f",onCancel:function(){},onConfirm:function(){T(t.id)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}]),k=function(){b((function(e){return e&&g(void 0),!e}))},T=function(e){o(!0),function(e){return q({url:"/v1/vul/".concat(e,"/"),method:"delete"})}(e).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),C()})).finally((function(){o(!1)}))},A=document.documentElement.offsetWidth;return l.a.createElement("div",{className:"vul-manage-table"},l.a.createElement("div",{className:"vul-controller"},l.a.createElement(ve.a,null,l.a.createElement(te.a,{icon:l.a.createElement(ne.PlusOutlined,null),type:"primary",onClick:k},"\u65b0\u5efa\u63cf\u8ff0")),l.a.createElement(Ce,{className:"custom-btn",allColumns:t,columns:s,setColumns:d})),l.a.createElement(pe.a,{columns:S,dataSource:j.list,rowKey:"id",loading:c,pagination:{current:j.page,pageSize:j.pagesize,total:j.total,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){w({type:"SET_PAGINATION",payload:{page:e,pagesize:t}})}}}),v&&l.a.createElement(He,{visible:v,onCancel:k,title:O?"\u6f0f\u6d1e\u63cf\u8ff0\u8be6\u60c5":"\u65b0\u5efa\u6f0f\u6d1e\u63cf\u8ff0",width:A,wrapClassName:"add-vul-wrap",selected:O,type:"vul"}))},Ye=function(e,t){var a=t.type,n=t.payload;switch(a){case"SET_SEARCH_QUERY":return Object(Z.a)(Object(Z.a)({},e),{},{search_query:n,page:1});case"SET_PAGINATION":return Object(Z.a)(Object(Z.a)({},e),{},{page:n.page,pagesize:n.pagesize});case"SET_BASIC":return Object(Z.a)(Object(Z.a)({},e),{},{basic:n});case"SET_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{list:n});case"SET_TOTAL":return Object(Z.a)(Object(Z.a)({},e),{},{total:n});case"SET_MODULE_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{moduleList:n});case"SET_SCRIPT_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{scriptList:n});case"SET_PRODUCT_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{productList:n});default:throw new Error("action type error")}},qe=function(e){var t=Object(n.useReducer)(Ye,ie),a=Object(f.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){Fe().then((function(e){c({type:"SET_BASIC",payload:e.data})})),Ie({page:1,pagesize:9999}).then((function(e){c({type:"SET_PRODUCT_LIST",payload:e.data.data})}))}),[]),l.a.createElement(ue.Provider,{value:{state:r,dispatch:c}},l.a.createElement("div",{className:"vul-manage-wrap"},l.a.createElement(de,null),l.a.createElement(Je,null)))},Ke=(a(2340),{search_query:{},page:1,pagesize:20,flag:!1,productList:[]}),Be=l.a.createContext({state:Ke,dispatch:function(){}}),Xe=["name","label","render"],Ze=function(e){var t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(n.useContext)(Be),c=r.state,o=r.dispatch,i=[{name:"enableField",label:"\u662f\u5426\u542f\u7528",render:function(){return l.a.createElement(oe.a,{placeholder:"\u72b6\u6001",style:{width:120},allowClear:!0},l.a.createElement(oe.a.Option,{value:"True"},"\u542f\u7528"),l.a.createElement(oe.a.Option,{value:"False"},"\u7981\u7528"))}},{name:"affectsField",label:"\u5f71\u54cd\u7c7b\u578b",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:200},allowClear:!0},null===(e=c.basic)||void 0===e?void 0:e.ModuleAffects.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"search",label:"\u6a21\u7cca\u67e5\u8be2"}];return l.a.createElement(x.a,{form:a,layout:"inline",className:"vul-manage-form",onFinish:function(e){o({type:"SET_SEARCH_QUERY",payload:e})}},i.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n),allowClear:!0})}:r,o=Object(ae.a)(e,Xe);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a},o),c())})),l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))},We=(a(243),a(133)),$e=a.n(We),et=(a(396),a(185)),tt=a.n(et),at=(a(397),a(184)),nt=a.n(at),lt=(a(398),a(54)),rt=a.n(lt),ct=(a(222),a(53)),ot=a.n(ct),it=a(131),ut=(a(2348),a(255)),st=a.n(ut),dt=function(e){var t,a,n=function(t){var a;null===(a=e.onChange)||void 0===a||a.call(e,Object(Z.a)(Object(Z.a)({},e.value),t))};return l.a.createElement("div",{className:e.className},l.a.createElement(g.a.Group,{compact:!0,style:{width:"92%",float:"left"}},l.a.createElement(g.a,{style:{width:"20%"},name:"key",value:null===e||void 0===e||null===(t=e.value)||void 0===t?void 0:t.key,onChange:function(e){n({key:e.target.value})},onBlur:e.handleBlur}),l.a.createElement(g.a,{style:{width:"80%"},name:"value",value:null===e||void 0===e||null===(a=e.value)||void 0===a?void 0:a.value,onChange:function(e){n({value:e.target.value})},onBlur:e.handleBlur})),l.a.createElement(ne.PlusCircleOutlined,{className:"dynamic-delete-button color-grey",type:"plus-circle-o",onClick:e.handleAdd}),e.showDeleteButton&&l.a.createElement(ne.MinusCircleOutlined,{className:"dynamic-delete-button color-red",type:"minus-circle-o",style:{color:"#ff6868"},onClick:function(){var t;return null===(t=e.handleDelete)||void 0===t?void 0:t.call(e,e.value.id)}}))};dt.defaultProps={showAddButton:!0,showDeleteButton:!0};var mt=dt,pt=function(e){console.log(e);var t=e.data,a=Object(n.useState)([{id:Et()}]),r=Object(f.a)(a,2),c=r[0],o=r[1];Object(n.useEffect)((function(){if(t.headers)if(Object.keys(t.headers).length>0){var e=Object.keys(t.headers).map((function(e){return{key:e,value:t.headers[e],id:Et()}}));o(e)}else o([{id:Et()}])}),[t]);var i=function(){o((function(e){return[].concat(Object(X.a)(e),[{id:Et()}])}))},u=function(e){o((function(t){return t.filter((function(t){return t.id!==e}))}))};return l.a.createElement("div",null,l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u8bf7\u6c42\u65b9\u6cd5 method\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(oe.a,{value:null===t||void 0===t?void 0:t.method,onChange:function(a){return e.setData(t.id,"method",a)},style:{width:"100%"}},l.a.createElement(oe.a.Option,{value:"GET"},"GET"),l.a.createElement(oe.a.Option,{value:"OPTIONS"},"OPTIONS"),l.a.createElement(oe.a.Option,{value:"HEAD"},"HEAD"),l.a.createElement(oe.a.Option,{value:"POST"},"POST"),l.a.createElement(oe.a.Option,{value:"PUT"},"PUT"),l.a.createElement(oe.a.Option,{value:"DELETE"},"DELETE"),l.a.createElement(oe.a.Option,{value:"PROPRFIND"},"PROPRFIND"),l.a.createElement(oe.a.Option,{value:"TRACE"},"TRACE"),l.a.createElement(oe.a.Option,{value:"CONNECT"},"CONNECT"),l.a.createElement(oe.a.Option,{value:"MOVE"},"MOVE"),l.a.createElement(oe.a.Option,{value:"TRACK"},"TRACK")))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u8bf7\u6c42\u8def\u5f84 path\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(g.a,{value:null===t||void 0===t?void 0:t.path,onChange:function(a){return e.setData(t.id,"path",a.target.value)}}))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u8bf7\u6c42\u5934 headers\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},c.map((function(e){return l.a.createElement(mt,{key:e.id,value:e,handleAdd:i,handleDelete:u,onChange:function(e){return function(e){console.log(e),o((function(t){return t.map((function(t){return t.id===e.id?e:t}))}))}(e)},showDeleteButton:c.length>1,className:"header-input-group"})})),l.a.createElement(te.a,{onClick:function(){var a={};c.forEach((function(e){console.log(e),e.key&&(a[e.key]=e.value)})),console.log(a),e.setData(t.id,"headers",a),I.a.success("\u4fdd\u5b58\u8bf7\u6c42\u5934\u6210\u529f")},type:"primary",ghost:!0},"\u4fdd\u5b58\u8bf7\u6c42\u5934"),l.a.createElement("span",{style:{color:"red",marginLeft:"10px"}},"\u6ce8\u610f\uff1a\u586b\u5199\u5b8c\u8bf7\u6c42\u5934\u540e\u8bf7\u70b9\u51fb\u8be5\u6309\u94ae\uff0c\u5426\u5219\u4e0d\u4f1a\u4fdd\u5b58\u8bf7\u6c42\u5934\uff01"))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u8bf7\u6c42\u4f53 body\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.body,onChange:function(a){return e.setData(t.id,"body",a.target.value)}}))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u5141\u8bb8\u8df3\u8f6c follow_redirects\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(nt.a,{checked:null===t||void 0===t?void 0:t.follow_redirects,onChange:function(a){return e.setData(t.id,"follow_redirects",a)}}))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u63d0\u53d6\u89c4\u5219 search\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.search,onChange:function(a){return e.setData(t.id,"search",a.target.value)}}))),l.a.createElement(Oe.a,{className:"run-test-items"},l.a.createElement(ye.a,{span:4},"\u8868\u8fbe\u5f0f expression\uff1a"),l.a.createElement(ye.a,{span:14,offset:1},l.a.createElement(g.a.TextArea,{value:null===t||void 0===t?void 0:t.expression,onChange:function(a){return e.setData(t.id,"expression",a.target.value)}}))))},ft=function(e){var t=e.data,a=function(a,n,l){var r=Object(Z.a)(Object(Z.a)({},t),{},{data:t.data.map((function(e){return e.id===a?Object(Z.a)(Object(Z.a)({},e),{},Object(it.a)({},n,l)):e}))});e.setData(r)},n=function(){var a=Object(Z.a)(Object(Z.a)({},t),{},{data:[].concat(Object(X.a)(t.data),[{id:Et()}])});e.setData(a)},r=function(a){console.log(a);var n=Object(Z.a)(Object(Z.a)({},t),{},{data:t.data.filter((function(e){return e.id!==a}))});e.setData(n)};return l.a.createElement("div",{className:"test-component-wrap"},"groups"===e.type&&l.a.createElement(g.a,{value:t.name,style:{width:"200px",margin:"10px 0"},onChange:function(a){return function(a){var n=Object(Z.a)(Object(Z.a)({},t),{},{name:a});e.setData(n)}(a.target.value)}}),l.a.createElement(st.a,{type:"editable-card",defaultActiveKey:"1",onEdit:function(e,t){"add"===t?n():h.a.confirm({title:"\u771f\u7684\u5220\u9664\uff1f",onOk:function(){r(e)}})},tabBarExtraContent:l.a.createElement(ve.a,null,"groups"===e.type&&l.a.createElement(Ee.a,{title:"\u771f\u7684\u5220\u9664\uff1f",onConfirm:function(){e.delete(t.id)}},l.a.createElement(te.a,{type:"link",danger:!0},"\u5220\u9664rules")))},t.data.map((function(e,t){return l.a.createElement(st.a.TabPane,{tab:"rule",key:e.id},l.a.createElement(pt,{data:e,setData:a}))}))))},vt=["id"],bt=l.a.forwardRef((function(e,t){var a=e.testData,r=(e.vulId,Object(n.useState)([])),c=Object(f.a)(r,2),o=c[0],i=c[1],u=Object(n.useState)([]),s=Object(f.a)(u,2),d=s[0],m=s[1],p=Object(n.useState)([]),v=Object(f.a)(p,2),b=v[0],E=v[1],h=Object(n.useState)({name:"",type:"rules",params:""}),O=Object(f.a)(h,2),y=O[0],j=O[1],w=Object(n.useState)([]),C=Object(f.a)(w,2),S=(C[0],C[1],Object(n.useState)(!1)),k=Object(f.a)(S,2),T=(k[0],k[1],Object(n.useState)(!1)),I=Object(f.a)(T,2);I[0],I[1];Object(n.useEffect)((function(){if(a){console.log(a);var e=a.set?Object.keys(a.set).map((function(e){return{name:e,value:a.set[e]}})):[],t=A(a.rules||[]),n=x(a.groups||{});i(t),a.hasOwnProperty("rules")?m([{name:"rules",data:t,id:Et()}]):m(n),E((null===e||void 0===e?void 0:e.map((function(e){return Object(Z.a)(Object(Z.a)({},e),{},{key:Et()})})))||[]),j({name:a.name,params:Array.isArray(a.params)?a.params.join(","):"",type:a.hasOwnProperty("rules")?"rules":"groups"})}else m([{name:"rules",data:[{id:Et()}],id:Et()}])}),[a]);var A=function(e){return e.map((function(e){return Object(Z.a)(Object(Z.a)({},e),{},{id:Et()})}))},x=function(e){return Object.keys(e).map((function(t){return{name:t,data:e[t].map((function(e){return Object(Z.a)(Object(Z.a)({},e),{},{id:Et()})})),id:Et()}}))},N=function(e){console.log(e);var t=d.map((function(t){return t.id===e.id?e:t}));m(t)},D=function(e){var t=d.filter((function(t){return t.id!==e}));m(t)},F=[{title:"name",dataIndex:"name",render:function(e,t){return l.a.createElement(g.a,{value:e,onChange:function(e){return _(e.target.value,"name",t)}})}},{title:"value",dataIndex:"value",render:function(e,t){return l.a.createElement(g.a,{value:e,onChange:function(e){return _(e.target.value,"value",t)}})}},{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement(te.a,{type:"link",icon:l.a.createElement(ne.DeleteOutlined,null),onClick:function(){return L(t.key)}})}}],L=function(e){E((function(t){return t.filter((function(t){return t.key!==e}))}))},_=function(e,t,a){E((function(n){return n.map((function(n){return n.key===a.key?Object(Z.a)(Object(Z.a)({},n),{},Object(it.a)({},t,e)):n}))}))},P=Object(n.useCallback)((function(){var e={};if(e.name=y.name,e.set=function(e){var t={};return e.forEach((function(e){t[e.name]=e.value})),t}(b),e.params=y.params.length>0?y.params.replace("\uff0c",",").split(","):[],"rules"===y.type){var t,a;e.rules=null===(t=d[0])||void 0===t||null===(a=t.data)||void 0===a?void 0:a.map((function(e){e.id;return Object(ae.a)(e,vt)}))}else{var n={};d.forEach((function(e){n[e.name]=e.data})),e.groups=n}return{json_poc:e}}),[o,b,y,d]);return Object(n.useImperativeHandle)(t,(function(){return{getRunTestData:P}}),[P]),l.a.createElement("div",{style:e.style,className:"run-test-wrap"},l.a.createElement(Oe.a,null,l.a.createElement(ye.a,{span:3,className:"rt-url-label"},"\u540d\u79f0\uff1a"),l.a.createElement(ye.a,{span:14},l.a.createElement(g.a,{value:null===y||void 0===y?void 0:y.name,onChange:function(e){e.persist(),j((function(t){return Object(Z.a)(Object(Z.a)({},t),{},{name:e.target.value})}))}}))),l.a.createElement(Oe.a,null,l.a.createElement(ye.a,{span:3,className:"rt-url-label"},"\u89c4\u5219\u7c7b\u578b\uff1a"),l.a.createElement(ye.a,{span:14},l.a.createElement(ot.a.Group,{onChange:function(e){j((function(t){return Object(Z.a)(Object(Z.a)({},t),{},{type:e.target.value})}))},value:null===y||void 0===y?void 0:y.type},l.a.createElement(ot.a,{value:"rules"},"rules"),l.a.createElement(ot.a,{value:"groups"},"groups")))),l.a.createElement(Oe.a,null,l.a.createElement(ye.a,{span:3,className:"rt-url-label"},"\u53c2\u6570 Payload\uff1a"),l.a.createElement(ye.a,{span:14},l.a.createElement(g.a.TextArea,{value:null===y||void 0===y?void 0:y.params,onChange:function(e){e.persist(),j((function(t){return Object(Z.a)(Object(Z.a)({},t),{},{params:e.target.value})}))},placeholder:"\u591a\u4e2a\u53c2\u6570\u8bf7\u4f7f\u7528,\u5206\u9694"}))),l.a.createElement(te.a,{type:"link",onClick:function(){E((function(e){return[].concat(Object(X.a)(e),[{key:Et()}])}))}},"\u6dfb\u52a0\u53d8\u91cf ",l.a.createElement(ne.PlusOutlined,null)),"groups"===y.type&&l.a.createElement(te.a,{type:"link",onClick:function(){m([].concat(Object(X.a)(d),[{name:"rules",data:[{id:Et()}],id:Et()}]))}},"\u6dfb\u52a0rules ",l.a.createElement(ne.PlusOutlined,null)),(null===b||void 0===b?void 0:b.length)>0&&l.a.createElement("h3",null,"Set\uff1a"),(null===b||void 0===b?void 0:b.length)>0&&l.a.createElement(pe.a,{dataSource:b,pagination:!1,columns:F}),null===d||void 0===d?void 0:d.map((function(e,t){return e&&l.a.createElement(ft,{data:e,type:y.type,setData:N,delete:D,key:t})})))}));function Et(){return(new Date).getTime()+""+Math.floor(1e4*Math.random())}var ht=function(e){return q({url:"/v1/poc/",method:"get",params:e})},Ot=function(e){return q({url:"/v1/poc/",method:"post",data:e})},gt=function(e,t){return q({url:"/v1/poc/".concat(t,"/"),method:"put",data:e})},yt=function(e){return q({url:"/v1/scan/url/",method:"post",data:e})},jt=function(e){return q({url:"/v1/scan/raw/",method:"post",data:e})},wt=function(e){return q({url:"/v1/scan/list/",method:"post",data:e})},Ct=["name","label","render"],St=function(e){var t,a=e.selected,r=e.type,c=void 0===r?"vul":r,o=Object(n.useRef)(null),i=Object(n.useState)(1),u=Object(f.a)(i,2),d=(u[0],u[1]),m=Object(n.useState)(null),p=Object(f.a)(m,2),v=p[0],b=p[1],E=Object(n.useState)([]),O=Object(f.a)(E,2),y=O[0],j=O[1],w=Object(n.useState)(void 0),C=Object(f.a)(w,2),S=C[0],k=C[1],T=Object(n.useState)(!0),A=Object(f.a)(T,2),N=A[0],D=A[1],F=Object(n.useState)(!1),L=Object(f.a)(F,2),_=L[0],P=L[1],z=Object(n.useState)(""),R=Object(f.a)(z,2),M=R[0],V=R[1],G=Object(n.useState)(""),Q=Object(f.a)(G,2),U=Q[0],Y=Q[1],K=Object(n.useContext)(Be),B=K.state,X=K.dispatch,W=x.a.useForm(),$=Object(f.a)(W,1)[0];Object(n.useEffect)((function(){a?(b(a),d(1),D(!1)):D(!1),De({page:1,pagesize:99999}).then((function(e){j(e.data.data)}))}),[a,c]);var ee=function(e){var t,a,n=J(),l=null===(t=o.current)||void 0===t?void 0:t.getRunTestData();Object(Z.a)(Object(Z.a)(Object(Z.a)({},v),e),{},{writer_id:null===n||void 0===n?void 0:n.id},l);console.log(l);try{(a=l,q({url:"/v1/poc/download/",method:"post",data:a})).then((function(e){var t=document.createElement("a"),a=new Blob(["\ufeff"+e.data],{type:"text/vnd.yaml"});t.style.display="none",t.href=URL.createObjectURL(a);for(var n="",l=0;l<10;l++)n+=Math.ceil(10*Math.random());t.setAttribute("download",n+".yaml"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}))}catch(r){console.log(r)}},ne=function(e){var t;P(!0),D(!0);var a,n=J(),l=null===(t=o.current)||void 0===t?void 0:t.getRunTestData(),r=Object(Z.a)(Object(Z.a)(Object(Z.a)({target:U},v),e),{},{writer_id:null===n||void 0===n?void 0:n.id},l);(a=r,q({url:"/v1/poc/run/",method:"post",data:a})).then((function(e){V(e.data)})).finally((function(){D(!1)}))},le=[{name:"vul_id",label:"\u6f0f\u6d1e\u7f16\u53f7",render:function(){return l.a.createElement(g.a,{placeholder:"\u6f0f\u6d1e\u7f16\u53f7\u65e0\u9700\u8f93\u5165 \u81ea\u52a8\u751f\u6210",disabled:!0})}},{name:"affects",label:"\u89c4\u5219\u7c7b\u578b",render:function(){var e;return l.a.createElement(oe.a,{placeholder:"\u9009\u62e9\u7c7b\u578b",style:{width:300}},null===(e=B.basic)||void 0===e?void 0:e.ModuleAffects.map((function(e){return l.a.createElement(oe.a.Option,{value:e.name,key:e.name},e.label)})))}},{name:"enable",label:"\u662f\u5426\u542f\u7528",valuePropName:"checked",render:function(){return l.a.createElement(nt.a,null)}},{name:"description",label:"\u6f0f\u6d1e\u63cf\u8ff0",render:function(){return l.a.createElement(oe.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:300},showSearch:!0,optionFilterProp:"children"},y.map((function(e){return l.a.createElement(oe.a.Option,{value:e.id,key:e.id,title:e.name_zh},e.name_zh)})))}}],re=document.documentElement.offsetHeight,ce={name:"yaml",action:"/api/v1/poc/upload/",headers:{Authorization:"JWT ".concat(H())},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),"done"===e.file.status?(console.log(e),b((function(t){var a,n,l;return Object(Z.a)(Object(Z.a)({},t),{},{json_poc:null===e||void 0===e||null===(a=e.file)||void 0===a||null===(n=a.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.json_poc})})),I.a.success("".concat(e.file.name," \u4e0a\u4f20\u6210\u529f"))):"error"===e.file.status&&I.a.error("".concat(e.file.name," \u4e0a\u4f20\u5931\u8d25"))}};return l.a.createElement(h.a,Object.assign({},e,{destroyOnClose:!0,maskClosable:!1,onCancel:function(t){e.onCancel&&e.onCancel(t)},footer:l.a.createElement("div",null,l.a.createElement(l.a.Fragment,null,l.a.createElement("span",{style:{float:"left",lineHeight:"32px"}},"\u6d4b\u8bd5url\uff1a"),l.a.createElement(g.a,{style:{float:"left",width:"400px"},onChange:function(e){return Y(e.target.value)}}),l.a.createElement(te.a,{type:"primary",style:{float:"left",marginLeft:"10px"},onClick:function(){$.validateFields().then((function(e){ne(e)}))},loading:N},"\u6d4b\u8bd5\u89c4\u5219"),l.a.createElement("div",{style:{float:"left",marginLeft:"10px"}},l.a.createElement(tt.a,Object.assign({},ce,{showUploadList:!1}),l.a.createElement(te.a,{type:"primary"},"\u4e0a\u4f20yaml")),l.a.createElement(te.a,{type:"primary",style:{marginLeft:"10px"},onClick:function(){$.validateFields().then((function(e){ee(e)}))}},"\u4e0b\u8f7dyaml")),l.a.createElement(te.a,{type:"primary",onClick:function(){$.validateFields().then((function(t){!function(t){var a;D(!0);var n=J(),l=(null===v||void 0===v?void 0:v.id)||S?gt:Ot,r=null===(a=o.current)||void 0===a?void 0:a.getRunTestData();l(Object(Z.a)(Object(Z.a)(Object(Z.a)({},v),t),{},{writer_id:null===n||void 0===n?void 0:n.id},r),(null===v||void 0===v?void 0:v.id)||S).then((function(t){var a;k(null===t||void 0===t||null===(a=t.data)||void 0===a?void 0:a.id),I.a.success("\u4fdd\u5b58\u6210\u529f"),ht(Object(Z.a)(Object(Z.a)({},B.search_query),{},{page:B.page,pagesize:B.pagesize})).then((function(t){X({type:"SET_LIST",payload:t.data.data}),X({type:"SET_TOTAL",payload:t.data.total}),e.onCancel&&e.onCancel()}))})).finally((function(){D(!1)}))}(t)}))},loading:N},"\u4fdd\u5b58")),l.a.createElement(te.a,{onClick:e.onCancel},"\u53d6\u6d88")),bodyStyle:{maxHeight:re-120,overflowY:"scroll"}}),l.a.createElement(s.a,{spinning:N},l.a.createElement(x.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:$,name:"vul_detail",layout:"horizontal",initialValues:v}),le.map((function(e,t){var a=e.name,n=e.label,r=e.render,c=void 0===r?function(){return l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165".concat(n)})}:r,o=Object(ae.a)(e,Ct);return l.a.createElement(x.a.Item,Object.assign({label:n,key:t,name:a},o),c())}))),l.a.createElement("h3",{className:"poc_title"},"\u89c4\u5219\u5185\u5bb9\uff1a"),l.a.createElement(bt,{ref:o,testData:null===v||void 0===v?void 0:v.json_poc,vulId:null!==(t=null===v||void 0===v?void 0:v.id)&&void 0!==t?t:S})),l.a.createElement(h.a,{visible:_,width:800,footer:null,onCancel:function(){P(!1),V([])},title:"poc\u8fd0\u884c\u7ed3\u679c",className:"test-result-wrap"},l.a.createElement(s.a,{spinning:N,size:"large"},function(e){console.log(e);var t=e.req_msg,a=e.resp_msg;return l.a.createElement("div",null,l.a.createElement(rt.a,{bordered:!0},(null===e||void 0===e?void 0:e.target)&&l.a.createElement(rt.a.Item,{label:"URL",span:3},null===e||void 0===e?void 0:e.target),l.a.createElement(rt.a.Item,{label:"\u662f\u5426\u6f0f\u6d1e",span:3},String(null===e||void 0===e?void 0:e.vulnerable)),(null===e||void 0===e?void 0:e.output)&&l.a.createElement(rt.a.Item,{label:"\u989d\u5916\u8bf4\u660e",span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},null===e||void 0===e?void 0:e.output)),t&&t.map((function(e,t){return l.a.createElement(l.a.Fragment,{key:t},l.a.createElement(rt.a.Item,{label:"Request".concat(t+1),span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},e)),l.a.createElement(rt.a.Item,{label:"Response".concat(t+1),span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},a[t])))}))))}(M))))},kt=function(e){var t=[{title:"\u6f0f\u6d1e\u7f16\u53f7",dataIndex:"vul_id",ellipsis:!1},{title:"\u72b6\u6001",dataIndex:"enable",ellipsis:!0,render:function(e){var t=e?"green":"volcano",a=e?"\u542f\u7528":"\u7981\u7528";return l.a.createElement($e.a,{color:t},a)}},{title:"poc\u540d\u79f0",dataIndex:"json_poc",ellipsis:!1,width:"20%",render:function(e){return e.name}},{title:"\u6f0f\u6d1e\u540d\u79f0",dataIndex:"desp_name",ellipsis:!1},{title:"\u5f71\u54cd\u7c7b\u578b",dataIndex:"affects",ellipsis:!0}],a=Object(n.useState)(!1),r=Object(f.a)(a,2),c=r[0],o=r[1],i=Object(n.useState)(Object(X.a)(t.slice(0,5))),u=Object(f.a)(i,2),s=u[0],d=u[1],m=Object(n.useState)(!1),p=Object(f.a)(m,2),v=p[0],b=p[1],E=Object(n.useState)(void 0),h=Object(f.a)(E,2),O=h[0],g=h[1],y=Object(n.useContext)(Be),j=y.state,w=y.dispatch,C=function(){o(!0),ht(Object(Z.a)(Object(Z.a)({},j.search_query),{},{page:j.page,pagesize:j.pagesize})).then((function(e){w({type:"SET_LIST",payload:e.data.data}),w({type:"SET_TOTAL",payload:e.data.total})})).finally((function(){o(!1)}))};Object(n.useEffect)((function(){C()}),[j.page,j.pagesize,j.search_query]);var S=[{title:"\u5e8f\u53f7",dataIndex:"order",width:"8%",render:function(e,t,a){return a+1}}].concat(Object(X.a)(s),[{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(e,t){return l.a.createElement("div",null,l.a.createElement(te.a,{type:"link",onClick:function(){var e;o(!0),(e=t.id,q({url:"/v1/poc/".concat(e,"/"),method:"get"})).then((function(e){g(e.data||t),k()})).finally((function(){o(!1)}))}},"\u8be6\u60c5"),l.a.createElement(Ee.a,{title:"\u771f\u7684\u5220\u9664\uff1f",onCancel:function(){},onConfirm:function(){T(t.id)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}]),k=function(){b((function(e){return e&&g(void 0),!e}))},T=function(e){o(!0),function(e){return q({url:"/v1/poc/".concat(e),method:"delete"})}(e).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),C()})).finally((function(){o(!1)}))},A=document.documentElement.offsetWidth;return l.a.createElement("div",{className:"vul-manage-table"},l.a.createElement("div",{className:"vul-controller"},l.a.createElement(te.a,{icon:l.a.createElement(ne.PlusOutlined,null),type:"primary",onClick:k},"\u65b0\u5efapoc"),l.a.createElement(Ce,{className:"custom-btn",allColumns:t,columns:s,setColumns:d})),l.a.createElement(pe.a,{columns:S,dataSource:j.list,rowKey:"id",loading:c,pagination:{current:j.page,pageSize:j.pagesize,total:j.total,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){w({type:"SET_PAGINATION",payload:{page:e,pagesize:t}})}}}),v&&l.a.createElement(St,{visible:v,onCancel:k,title:O?"poc\u8be6\u60c5":"\u65b0\u589epoc",width:A,wrapClassName:"add-vul-wrap",selected:O,type:"vul"}))},Tt=function(e,t){var a=t.type,n=t.payload;switch(a){case"SET_SEARCH_QUERY":return Object(Z.a)(Object(Z.a)({},e),{},{search_query:n,page:1});case"SET_PAGINATION":return Object(Z.a)(Object(Z.a)({},e),{},{page:n.page,pagesize:n.pagesize});case"SET_BASIC":return Object(Z.a)(Object(Z.a)({},e),{},{basic:n});case"SET_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{list:n});case"SET_TOTAL":return Object(Z.a)(Object(Z.a)({},e),{},{total:n});case"SET_MODULE_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{moduleList:n});case"SET_SCRIPT_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{scriptList:n});case"SET_PRODUCT_LIST":return Object(Z.a)(Object(Z.a)({},e),{},{productList:n});case"TOGGLE_FLAG":return Object(Z.a)(Object(Z.a)({},e),{},{flag:!e.flag});default:throw new Error("action type error")}},It=function(e){var t=Object(n.useReducer)(Tt,Ke),a=Object(f.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){Fe().then((function(e){c({type:"SET_BASIC",payload:e.data})})),Ie({page:1,pagesize:9999}).then((function(e){c({type:"SET_PRODUCT_LIST",payload:e.data.data})}))}),[]),l.a.createElement(Be.Provider,{value:{state:r,dispatch:c}},l.a.createElement("div",{className:"vul-manage-wrap"},l.a.createElement(Ze,null),l.a.createElement(kt,null)))},At=(a(2367),a(2387)),xt=a(2386),Nt=function(e){var t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(n.useState)("all"),c=Object(f.a)(r,2),o=c[0],i=c[1],u=Object(n.useState)("url"),s=Object(f.a)(u,2),d=s[0],m=s[1],p=Object(n.useState)([]),v=Object(f.a)(p,2),b=v[0],E=v[1],O=Object(n.useState)([]),y=Object(f.a)(O,2),j=y[0],w=y[1];Object(n.useEffect)((function(){ht({page:1,pagesize:99999}).then((function(e){E(e.data.data)}))}),[]);var C={onChange:function(e){var t=Object(X.a)(e.fileList);t=t.slice(-1),w(t)},onRemove:function(e){w([])},beforeUpload:function(e){return console.log(e),w([e]),!1},fileList:j};return l.a.createElement(h.a,Object.assign({},e,{maskClosable:!1,onOk:function(){a.validateFields().then((function(t){console.log(t),console.log(j);var a,n=t.targetType;"url"!==n?((a=new FormData).append("target",t.target[0].originFileObj),a.append("type",t.type),a.append("vul_list",t.vul_list),a.append("remarks",t.remarks)):a=t,("raw"===n?jt:"url_list"===n?wt:yt)(a).then((function(t){console.log(t),I.a.success("\u4efb\u52a1\u521b\u5efa\u6210\u529f"),e.onCancel()}))}))}}),l.a.createElement(x.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:16}},{form:a,initialValues:{type:o,targetType:d}}),l.a.createElement(x.a.Item,{name:"remarks",label:"\u4efb\u52a1\u8bf4\u660e"},l.a.createElement(g.a.TextArea,null)),l.a.createElement(x.a.Item,{name:"type",label:"\u626b\u63cf\u7c7b\u578b"},l.a.createElement(ot.a.Group,{onChange:function(e){i(e.target.value)}},l.a.createElement(ot.a,{value:"all"},"\u52a0\u8f7d\u6240\u6709\u89c4\u5219"),l.a.createElement(ot.a,{value:"multi"},"\u81ea\u5b9a\u4e49\u591a\u4e2a\u89c4\u5219"))),"multi"===o&&l.a.createElement(x.a.Item,{name:"vul_list",label:"\u89c4\u5219\u5217\u8868"},l.a.createElement(oe.a,{allowClear:!0,mode:"multiple",optionFilterProp:"children",filterOption:function(e,t){return(null===t||void 0===t?void 0:t.children.toLowerCase().indexOf(e.toLowerCase()))>=0}},b.map((function(e){return l.a.createElement(oe.a.Option,{value:e.vul_id,key:e.vul_id},e.desp_name)})))),l.a.createElement(x.a.Item,{name:"targetType",label:"\u6d4b\u8bd5\u76ee\u6807\u7c7b\u578b"},l.a.createElement(ot.a.Group,{onChange:function(e){m(e.target.value)}},l.a.createElement(ot.a,{value:"url"},"\u5355\u4e2aurl"),l.a.createElement(ot.a,{value:"raw"},"\u8bf7\u6c42raw\u6587\u4ef6"),l.a.createElement(ot.a,{value:"url_list"},"url\u5217\u8868\u6587\u4ef6"))),"url"===d&&l.a.createElement(x.a.Item,{name:"target",label:"\u6d4b\u8bd5\u76ee\u6807"},l.a.createElement(g.a,null)),("raw"===d||"url_list"===d)&&l.a.createElement(x.a.Item,{name:"target",label:"\u4e0a\u4f20",valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList.slice(-1)}},l.a.createElement(tt.a,C,l.a.createElement(te.a,{icon:l.a.createElement(xt.a,null)},"\u70b9\u51fb\u4e0a\u4f20")))))},Dt=function(){var e=x.a.useForm(),t=Object(f.a)(e,1)[0],a=Object(p.g)(),r=Object(n.useState)({page:1,pagesize:10,search:""}),c=Object(f.a)(r,2),o=c[0],i=c[1],u=Object(n.useState)([]),s=Object(f.a)(u,2),d=s[0],m=s[1],v=Object(n.useState)(0),b=Object(f.a)(v,2),E=b[0],h=b[1],O=Object(n.useState)(!1),y=Object(f.a)(O,2),j=y[0],w=y[1];Object(n.useEffect)((function(){(function(e){return q({url:"/v1/task/",method:"get",params:e})})(o).then((function(e){m(e.data.data),h(e.data.total)}))}),[o]);var C=function(e){var t;console.log(e),(t=e.id,q({url:"/v1/task/".concat(t,"/"),method:"delete"})).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),i((function(e){return Object(Z.a)({},e)}))}))},S=[{title:"\u5e8f\u53f7",dataIndex:"order",width:"8%",render:function(e,t,a){return a+1}},{title:"\u4efb\u52a1ID",dataIndex:"id"},{title:"\u76ee\u6807",dataIndex:"target"},{title:"\u4efb\u52a1\u8bf4\u660e",dataIndex:"remarks"},{title:"\u521b\u5efa\u8005",dataIndex:"operator"},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:function(e){var t="down"===e?"green":"geekblue";return l.a.createElement($e.a,{color:t,key:e},e)}},{title:"\u64cd\u4f5c",render:function(e,t){return l.a.createElement(l.a.Fragment,null,l.a.createElement(te.a,{type:"link",onClick:function(){a.push({pathname:"/result",state:{id:t.id}})}},"\u626b\u63cf\u7ed3\u679c"),l.a.createElement(Ee.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u4efb\u52a1\u5417",onConfirm:function(){return C(t)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}];return l.a.createElement("div",{className:"task-wrap"},l.a.createElement(ve.a,{direction:"vertical",size:"middle"},l.a.createElement(x.a,{form:t,layout:"inline",onFinish:function(e){i((function(t){return Object(Z.a)(Object(Z.a)(Object(Z.a)({},t),e),{},{page:1})}))}},l.a.createElement(x.a.Item,{label:"\u5173\u952e\u5b57",name:"search"},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57",allowClear:!0})),l.a.createElement(x.a.Item,null,l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))),l.a.createElement(te.a,{icon:l.a.createElement(At.a,null),type:"primary",onClick:function(){w(!0)}},"\u521b\u5efa\u626b\u63cf\u4efb\u52a1")),l.a.createElement(pe.a,{className:"task-table",columns:S,dataSource:d,rowKey:"id",pagination:{current:o.page,pageSize:o.pagesize,total:E,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){i((function(a){return Object(Z.a)(Object(Z.a)({},a),{},{page:e,pagesize:t||10})}))}}}),j&&l.a.createElement(Nt,{width:800,visible:j,title:"\u521b\u5efa\u626b\u63cf\u4efb\u52a1",onCancel:function(){return w(!1)}}))},Ft=(a(2368),a(410)),Lt=a.n(Ft),_t=function(){var e,t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(p.h)(),c=null===r||void 0===r||null===(e=r.state)||void 0===e?void 0:e.id,o=Object(n.useState)({page:1,pagesize:10,search:"",taskField:c||""}),i=Object(f.a)(o,2),u=i[0],s=i[1],d=Object(n.useState)([]),m=Object(f.a)(d,2),v=m[0],b=m[1],E=Object(n.useState)(0),O=Object(f.a)(E,2),y=O[0],j=O[1],w=Object(n.useState)(!1),C=Object(f.a)(w,2),S=C[0],k=C[1],T=Object(n.useState)([]),A=Object(f.a)(T,2),N=A[0];A[1];Object(n.useEffect)((function(){(function(e){return q({url:"/v1/result/",method:"get",params:e})})(u).then((function(e){b(e.data.data),j(e.data.total)}))}),[u]);var D=function(e){var t;console.log(e),(t=e.id,q({url:"/v1/result/".concat(t,"/"),method:"delete"})).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),s((function(e){return Object(Z.a)({},e)}))}))},F=[{title:"\u5e8f\u53f7",dataIndex:"order",width:"8%",render:function(e,t,a){return a+1}},{title:"\u7ed3\u679cID",dataIndex:"id"},{title:"\u63d2\u4ef6ID",dataIndex:"plugin_id"},{title:"\u63d2\u4ef6\u540d\u79f0",dataIndex:"plugin_name"},{title:"\u4efb\u52a1ID",dataIndex:"task_id"},{title:"\u5b58\u5728\u6f0f\u6d1e",key:"vul",dataIndex:"vul",render:function(e){var t=e?"volcano":"green",a=e?"\u662f":"\u5426";return l.a.createElement($e.a,{color:t,key:e},a)}},{title:"\u64cd\u4f5c",render:function(e,t){return l.a.createElement(ve.a,null,l.a.createElement(Ee.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5\u7ed3\u679c\u5417",onConfirm:function(){return D(t)}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))}}];return l.a.createElement("div",{className:"result-wrap"},l.a.createElement(x.a,{form:a,layout:"inline",onFinish:function(e){s((function(t){return Object(Z.a)(Object(Z.a)(Object(Z.a)({},t),e),{},{page:1})}))},initialValues:u},l.a.createElement(x.a.Item,{label:"\u641c\u7d22",name:"search"},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57",allowClear:!0})),l.a.createElement(x.a.Item,{label:"\u4efb\u52a1ID",name:"taskField"},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1ID",allowClear:!0})),l.a.createElement(x.a.Item,{label:"\u662f\u5426\u5b58\u5728\u6f0f\u6d1e",name:"vulField"},l.a.createElement(oe.a,{allowClear:!0,style:{width:160},placeholder:"\u8bf7\u9009\u62e9"},l.a.createElement(oe.a.Option,{value:1},"\u662f"),l.a.createElement(oe.a.Option,{value:0},"\u5426"))),l.a.createElement(x.a.Item,null,l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2"))),l.a.createElement(pe.a,{className:"result-table",columns:F,dataSource:v,rowKey:"id",expandable:{expandedRowRender:function(e){return function(e){var t,a,n,r,c;console.log(e);var o=null===e||void 0===e?void 0:e.detail,i=o.req_msg,u=o.resp_msg;return l.a.createElement("div",null,l.a.createElement(rt.a,{bordered:!0},(null===e||void 0===e||null===(t=e.detail)||void 0===t?void 0:t.target)&&l.a.createElement(rt.a.Item,{label:"URL",span:3},null===e||void 0===e||null===(a=e.detail)||void 0===a?void 0:a.target),l.a.createElement(rt.a.Item,{label:"\u662f\u5426\u6f0f\u6d1e",span:3},String(null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.vulnerable)),(null===e||void 0===e||null===(r=e.detail)||void 0===r?void 0:r.output)&&l.a.createElement(rt.a.Item,{label:"\u989d\u5916\u8bf4\u660e",span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},null===e||void 0===e||null===(c=e.detail)||void 0===c?void 0:c.output)),i&&i.map((function(e,t){return l.a.createElement(l.a.Fragment,{key:t},l.a.createElement(rt.a.Item,{label:"Request".concat(t+1),span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},e)),l.a.createElement(rt.a.Item,{label:"Response".concat(t+1),span:3},l.a.createElement("span",{style:{whiteSpace:"pre-wrap"}},u[t])))}))))}(e)},rowExpandable:function(e){return!!e.detail}},pagination:{current:u.page,pageSize:u.pagesize,total:y,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){s((function(a){return Object(Z.a)(Object(Z.a)({},a),{},{page:e,pagesize:t||10})}))}}}),l.a.createElement(h.a,{visible:S,width:1300,footer:null,onCancel:function(){k(!1)},title:"\u8be6\u7ec6\u7ed3\u679c",className:"test-result-wrap"},l.a.createElement(Lt.a,{src:N,name:!1,displayDataTypes:!1})))},Pt=(a(2369),function(e){var t=x.a.useForm(),a=Object(f.a)(t,1)[0],r=Object(n.useState)([]),c=Object(f.a)(r,2),o=c[0],i=c[1],u=Object(n.useMemo)((function(){return[{title:"\u6a21\u5757\u540d\u79f0",dataIndex:"name",width:"20%"},{title:"\u811a\u672c\u7c7b\u578b",dataIndex:"type_id",render:function(e){var t;return null===(t=o.find((function(t){return t.id===e})))||void 0===t?void 0:t.type_name},width:"20%"},{title:"\u5907\u6ce8",dataIndex:"remarks",width:"30%"}]}),[o]),s=Object(n.useCallback)((function(){switch(e.type){case"product":default:return Re}}),[e.type,u]),d=s(),m=Object(n.useState)(Object(X.a)(d)),p=Object(f.a)(m,2),v=p[0],b=p[1],E=Object(n.useState)(!1),h=Object(f.a)(E,2),O=h[0],y=h[1],j=Object(n.useState)({page:1,pagesize:20}),w=Object(f.a)(j,2),C=w[0],S=w[1],k=Object(n.useState)([]),T=Object(f.a)(k,2),A=T[0],N=T[1],D=Object(n.useState)(0),F=Object(f.a)(D,2),L=F[0],_=F[1],P=Object(n.useState)(!1),z=Object(f.a)(P,2),R=z[0],M=z[1],V=Object(n.useState)(void 0),G=Object(f.a)(V,2),Q=G[0],U=G[1],H=Object(n.useCallback)((function(t){var a;switch(y(!0),e.type){case"product":a=Ie;break;default:a=Ie}a(t).then((function(e){N(e.data.data),_(e.data.total)})).finally((function(){y(!1)}))}),[e.type]);Object(n.useEffect)((function(){H(C)}),[C,H]),Object(n.useEffect)((function(){"script"===e.type&&Fe().then((function(e){i(e.data.ScriptType)}))}),[e.type]),Object(n.useEffect)((function(){b(Object(X.a)(s()))}),[s]);var J=[{title:"\u5e8f\u53f7",dataIndex:"order",render:function(e,t,a){return a+1},width:"15%"}].concat(Object(X.a)(v),[{title:"\u64cd\u4f5c",dataIndex:"operation",render:function(t,a){return l.a.createElement("div",null,l.a.createElement(te.a,{type:"link",onClick:function(){U(a),q()}},"\u7f16\u8f91"),l.a.createElement(Ee.a,{title:"\u786e\u5b9a\u5220\u9664\u8be5".concat("script"===e.type?"\u811a\u672c":"product"===e.type?"\u7ec4\u4ef6":"\u6a21\u5757","\u5417\uff1f"),onConfirm:function(){return Y(a.id)},onCancel:function(){}},l.a.createElement(te.a,{type:"link"},"\u5220\u9664")))},width:"15%"}]),Y=function(t){var a;switch(e.type){case"product":a=xe;break;default:a=xe}a(t).then((function(e){I.a.success("\u5220\u9664\u6210\u529f"),H(C)}))},q=function(){M((function(e){return e&&U(void 0),!e}))};return l.a.createElement("div",{className:"module-manage-wrap"},l.a.createElement(x.a,{form:a,layout:"inline",onFinish:function(e){console.log(e),S((function(t){return Object(Z.a)(Object(Z.a)({},t),{},{page:1},e)}))}},l.a.createElement(x.a.Item,{label:"\u6a21\u7cca\u67e5\u8be2",name:"search"},l.a.createElement(g.a,{placeholder:"\u8bf7\u8f93\u5165\u6a21\u7cca\u67e5\u8be2",allowClear:!0})),l.a.createElement(te.a,{type:"primary",htmlType:"submit"},"\u67e5\u8be2")),l.a.createElement("div",{className:"module-table-wrap"},l.a.createElement("div",{className:"module-controller"},l.a.createElement(ve.a,null,l.a.createElement(te.a,{icon:l.a.createElement(ne.PlusOutlined,null),type:"primary",onClick:q},"\u65b0\u5efa")),l.a.createElement(Ce,{className:"custom-btn",allColumns:d,columns:v,setColumns:b})),l.a.createElement(pe.a,{columns:J,dataSource:A,rowKey:"id",loading:O,pagination:{current:C.page,pageSize:C.pagesize,total:L,showTotal:function(e){return"\u5171".concat(e,"\u6761")},showQuickJumper:!0,showSizeChanger:!0,onChange:function(e,t){S((function(a){return Object(Z.a)(Object(Z.a)({},a),{},{page:e,pagesize:t})}))}}}),l.a.createElement(Ge,{visible:R,onCancel:q,onOk:function(t){var a;switch(console.log(t),e.type){case"product":a=Q?Ne:Ae;break;default:a=Q?Ne:Ae}a(t,null===Q||void 0===Q?void 0:Q.id).then((function(e){console.log(e),H(C),q()}))},scriptType:o,type:e.type,selected:Q})))}),zt=[{path:"/login",key:"/login",component:re,hidden:!0},{path:"/poc",key:"/poc",component:It,meta:{name:"\u6f0f\u6d1e\u89c4\u5219",icon:"icon--_xitongrizhi"}},{path:"/vul",key:"/vul",component:qe,meta:{name:"\u6f0f\u6d1e\u63cf\u8ff0",icon:"icon-chakan-copy"}},{path:"/task",key:"/task",component:Dt,meta:{name:"\u4efb\u52a1\u5217\u8868",icon:"icon-ai226"}},{path:"/result",key:"/result",component:_t,meta:{name:"\u626b\u63cf\u7ed3\u679c",icon:"icon-xinxi1"}},{path:"/product",key:"/product",component:function(){return l.a.createElement(Pt,{type:"product"})},meta:{name:"\u5f71\u54cd\u7ec4\u4ef6",icon:"icon-qita"}}];var Rt=function e(t){for(var a=[],n=0;n<t.length;n++){var l=t[n];a.push(Object(Z.a)({},l)),(null===l||void 0===l?void 0:l.subMenu)&&a.push.apply(a,Object(X.a)(e(l.subMenu)))}return a}(zt),Mt=a(2383),Vt=Object(Mt.a)({scriptUrl:"//at.alicdn.com/t/font_1871150_pfyscyl84i.js"}),Gt=b.a.Sider,Qt=k.a.SubMenu,Ut=function(e){var t=Object(p.g)().location.pathname,a=Object(n.useState)([]),r=Object(f.a)(a,2),c=r[0],o=r[1],i=Object(n.useContext)(P).state;Object(n.useEffect)((function(){o([t])}),[t]);var u=Object(n.useMemo)((function(){return zt.filter((function(e){return!e.hidden})).map((function(e){var t,a,n,r;if(!e.subMenu)return l.a.createElement(k.a.Item,{key:e.key,className:"side-item-wrap"},l.a.createElement(m.b,{to:e.path},l.a.createElement(Vt,{type:null===e||void 0===e||null===(n=e.meta)||void 0===n?void 0:n.icon}),l.a.createElement("span",null,null===e||void 0===e||null===(r=e.meta)||void 0===r?void 0:r.name)));var c=l.a.createElement("span",null,l.a.createElement(Vt,{type:null===e||void 0===e||null===(t=e.meta)||void 0===t?void 0:t.icon}),l.a.createElement("span",null,null===e||void 0===e||null===(a=e.meta)||void 0===a?void 0:a.name)),o=null===e||void 0===e?void 0:e.subMenu.filter((function(e){return!e.hidden})).map((function(e){return l.a.createElement(k.a.Item,{key:e.key,className:"side-item"},l.a.createElement(m.b,{to:e.path},l.a.createElement("span",null,e.meta.name)))}));return l.a.createElement(Qt,{key:null===e||void 0===e?void 0:e.key,title:c},o)}))}),[]);return l.a.createElement(Gt,{trigger:null,collapsible:!0,collapsed:i.collapsed,width:210,style:{height:"100vh",left:0,overflow:"auto",position:"fixed"}},l.a.createElement("h2",{className:"logo"},"POCASSIST"),l.a.createElement(k.a,{theme:"dark",mode:"inline",selectedKeys:c},u))},Ht=function(e){return l.a.createElement(p.d,null,Rt.filter((function(e){return null===e||void 0===e?void 0:e.component})).map((function(e){var t=e.component;return l.a.createElement(p.b,{exact:!0,key:e.key,path:e.path,render:function(e){return l.a.createElement(t,e)}})})),l.a.createElement(p.a,{from:"/",to:"/login",push:!0}))},Jt=function(e,t){switch(t.type){case"TOGGLE_COLLAPSED":return Object(Z.a)(Object(Z.a)({},e),{},{collapsed:!e.collapsed});default:throw new Error("action type error")}},Yt=function(e){return"/login"!==Object(p.h)().pathname?l.a.createElement(p.a,{to:"/login",push:!0}):l.a.createElement(p.b,null,l.a.createElement(b.a,{className:"un-auth-layout"},l.a.createElement(Ht,null)))},qt=b.a.Footer,Kt=function(e){var t=Object(n.useReducer)(Jt,_),a=Object(f.a)(t,2),r=a[0],c=a[1],o=H(),i=Object(p.h)();return o&&"/login"!==i.pathname?l.a.createElement(P.Provider,{value:{state:r,dispatch:c}},l.a.createElement(b.a,null,l.a.createElement(Ut,null),l.a.createElement(b.a,{className:"main-wrap"},l.a.createElement(B,null),l.a.createElement("div",{className:"main-content"},l.a.createElement(Ht,null)),l.a.createElement(qt,{style:{textAlign:"center"}},"POCASSIST \xa92021 Created by ",l.a.createElement("a",{href:"https://github.com/jweny"},"jweny"))))):l.a.createElement(Yt,null)};a(2370);var Bt=function(){return l.a.createElement(l.a.Suspense,{fallback:l.a.createElement(s.a,{size:"large",className:"app-loading"})},l.a.createElement(i.a,{locale:d.a},l.a.createElement(m.a,{basename:"/"},l.a.createElement(p.d,null,l.a.createElement(Kt,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(l.a.createElement(Bt,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},336:function(e,t,a){},403:function(e,t){e.exports="data:image/png;base64,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"},412:function(e,t,a){e.exports=a(2372)},417:function(e,t,a){},422:function(e,t){function a(){var e=document.documentElement.clientWidth/1920;document.documentElement.style.fontSize=192*e+"px"}a(),window.addEventListener("resize",(function(){a()}))},640:function(e,t,a){}},[[412,1,2]]]);